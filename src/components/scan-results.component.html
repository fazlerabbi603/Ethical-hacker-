
<div class="bg-gray-800/50 backdrop-blur-sm border border-gray-700 rounded-lg shadow-lg overflow-hidden">
  <!-- Tabs Navigation -->
  <div class="border-b border-gray-700">
    <nav class="flex space-x-2 p-2" aria-label="Tabs">
      <button (click)="setActiveTab('summary')"
        [class]="activeTab() === 'summary' ? 'bg-green-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-white'"
        class="px-4 py-2 font-medium text-sm rounded-md transition-colors">
        Summary
      </button>
      <button (click)="setActiveTab('vulnerabilities')"
        [class]="activeTab() === 'vulnerabilities' ? 'bg-green-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-white'"
        class="px-4 py-2 font-medium text-sm rounded-md transition-colors flex items-center gap-2">
        Vulnerabilities
        <span class="bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">{{ results().vulnerabilities.length }}</span>
      </button>
      <button (click)="setActiveTab('ports')"
        [class]="activeTab() === 'ports' ? 'bg-green-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-white'"
        class="px-4 py-2 font-medium text-sm rounded-md transition-colors">
        Common Ports
      </button>
      <button (click)="setActiveTab('headers')"
        [class]="activeTab() === 'headers' ? 'bg-green-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-white'"
        class="px-4 py-2 font-medium text-sm rounded-md transition-colors">
        HTTP Headers
      </button>
    </nav>
  </div>

  <!-- Tabs Content -->
  <div class="p-6">
    @switch (activeTab()) {
      @case ('summary') {
        <div>
          <h3 class="text-xl font-semibold text-green-300 mb-4">Analysis Summary</h3>
          <p class="text-gray-300 whitespace-pre-wrap leading-relaxed">{{ results().summary }}</p>
        </div>
      }
      @case ('vulnerabilities') {
        <div>
          <h3 class="text-xl font-semibold text-green-300 mb-4">Potential Vulnerabilities</h3>
          <div class="space-y-4">
            @if(results().vulnerabilities.length > 0) {
              @for (vuln of results().vulnerabilities; track vuln.name) {
                <div class="border-l-4 p-4 rounded-r-lg" [class]="getSeverityClass(vuln.severity)">
                  <div class="flex justify-between items-center mb-2">
                    <h4 class="text-lg font-bold text-gray-100">{{ vuln.name }}</h4>
                    <span class="px-3 py-1 text-sm font-bold rounded-full" [class]="getSeverityClass(vuln.severity) + ' ' + getSeverityTextClass(vuln.severity)">
                      {{ vuln.severity }}
                    </span>
                  </div>
                  <p class="text-gray-300 mb-3 text-sm">{{ vuln.description }}</p>
                  <div class="bg-gray-900/50 p-3 rounded">
                      <h5 class="font-semibold text-green-400 mb-1 text-sm">Recommendation</h5>
                      <p class="text-gray-400 text-sm">{{ vuln.recommendation }}</p>
                  </div>
                </div>
              }
            } @else {
              <p class="text-gray-400">No specific vulnerabilities were identified in this theoretical scan.</p>
            }
          </div>
        </div>
      }
      @case ('ports') {
        <div>
          <h3 class="text-xl font-semibold text-green-300 mb-4">Commonly Associated Ports</h3>
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-700">
              <thead class="bg-gray-800">
                <tr>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Port</th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Service</th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Status</th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Description</th>
                </tr>
              </thead>
              <tbody class="bg-gray-900/50 divide-y divide-gray-700">
                @for (port of results().openPorts; track port.port) {
                  <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-green-400">{{ port.port }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">{{ port.service }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                      <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-900 text-yellow-300">{{ port.status }}</span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-400">{{ port.description }}</td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>
      }
      @case ('headers') {
        <div>
          <h3 class="text-xl font-semibold text-green-300 mb-4">HTTP Security Header Analysis</h3>
          <div class="space-y-4">
             @for (header of results().headers; track header.name) {
                <div class="bg-gray-900/50 p-4 rounded-lg border border-gray-700">
                  <h4 class="font-bold text-green-400">{{ header.name }}</h4>
                  <p class="text-sm text-gray-300 font-mono my-2 bg-black/30 p-2 rounded">Value: <span class="text-yellow-300">{{ header.value }}</span></p>
                  <p class="text-sm text-gray-400">{{ header.securityNote }}</p>
                </div>
              }
          </div>
        </div>
      }
    }
  </div>
</div>
